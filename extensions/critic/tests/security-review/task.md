Review and fix security vulnerabilities in auth.ts:
1. Fix any SQL injection vulnerabilities
2. Fix password handling issues
3. Add proper input sanitization
4. Implement secure session management